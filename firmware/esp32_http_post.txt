ESP32 - Envoi des mesures vers le serveur (HTTP POST)

1) Remplacer WIFI_SSID, WIFI_PASS et API_URL
2) Televerser ce code dans l'ESP32

```
#include <WiFi.h>
#include <HTTPClient.h>
#include <OneWire.h>
#include <DallasTemperature.h>

// === A REMPLACER ===
const char* WIFI_SSID = "YOUR_SSID";
const char* WIFI_PASS = "YOUR_PASSWORD";
// IP du PC qui heberge le serveur Node (meme reseau que l'ESP32)
const char* API_URL = "http://192.168.1.10:3000/api/v1/metrics";

// === CAPTEURS ===
const int ONE_WIRE_BUS = 4;  // DS18B20
const int PH_PIN = 34;       // capteur pH (analog)
const int TURB_PIN = 35;     // capteur turbidite (analog)
const int LEVEL_PIN = 32;    // capteur niveau d'eau (analog)

OneWire oneWire(ONE_WIRE_BUS);
DallasTemperature sensors(&oneWire);

float readPH() {
  int raw = analogRead(PH_PIN);
  return (raw / 4095.0) * 14.0; // a calibrer
}

float readTurbidity() {
  int raw = analogRead(TURB_PIN);
  return (raw / 4095.0) * 40.0; // a calibrer
}

float readWaterLevel() {
  int raw = analogRead(LEVEL_PIN);
  return (raw / 4095.0) * 100.0; // 0-100%
}

float readHumidity() {
  // Si pas de capteur humidite, mettre une valeur fixe
  return 50.0;
}

void setup() {
  Serial.begin(115200);
  sensors.begin();

  WiFi.begin(WIFI_SSID, WIFI_PASS);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("\nWiFi connected");
}

void loop() {
  sensors.requestTemperatures();
  float tempC = sensors.getTempCByIndex(0);
  float ph = readPH();
  float turbidity = readTurbidity();
  float level = readWaterLevel();
  float humidity = readHumidity();

  Serial.printf("Temp: %.2f C | pH: %.2f | Turb: %.2f | Level: %.2f%% | Hum: %.2f%%\n",
                tempC, ph, turbidity, level, humidity);

  if (WiFi.status() == WL_CONNECTED) {
    HTTPClient http;
    http.begin(API_URL);
    http.addHeader("Content-Type", "application/json");

    String payload = String("{\"temperature\":") + tempC +
      ",\"ph\":" + ph +
      ",\"turbidity\":" + turbidity +
      ",\"water_level\":" + level +
      ",\"humidity\":" + humidity + "}";

    int code = http.POST(payload);
    Serial.printf("POST status: %d\n", code);
    http.end();
  }

  delay(10000);
}
```
